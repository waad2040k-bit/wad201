{% load static %}
<header class="site-header" dir="rtl">
  <style>
    :root{
      --bg: #fbf3ea;         /* بيج فاتح */
      --card: #ffffffcc;
      --text: #2a2320;
      --muted: #6d5f58;
      --pink: #d99aa8;       /* وردي */
      --pink-2: #f0b7c3;
      --stroke: #ecd9cf;
      --shadow: 0 10px 30px rgba(42,35,32,.08);
      --radius: 18px;
      --radius-lg: 24px;
    }

    .site-header{
      position: sticky;
      top: 0;
      z-index: 50;
      background: linear-gradient(180deg, var(--bg), rgba(251,243,234,.86));
      backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--stroke);
    }

    .header-wrap{
      max-width: 1200px;
      margin: 0 auto;
      padding: 14px 16px;
      display: grid;
      grid-template-columns: 1fr auto 1fr;
      gap: 12px;
      align-items: center;
    }

    .brand{
      display:flex;
      align-items:center;
      gap:10px;
      text-decoration:none;
      color: var(--text);
      font-weight: 800;
      letter-spacing: .2px;
      min-width: 0;
    }

    .brand-mark{
      width: 42px;
      height: 42px;
      border-radius: 14px;
      background: radial-gradient(circle at 30% 30%, var(--pink-2), var(--pink));
      box-shadow: var(--shadow);
      display:grid;
      place-items:center;
      border: 1px solid rgba(255,255,255,.7);
      flex: 0 0 auto;
    }

    .brand-mark svg{ width: 22px; height: 22px; fill: #fff; opacity:.95; }

    .brand-text{
      display:flex;
      flex-direction:column;
      line-height: 1.1;
      min-width: 0;
    }
    .brand-text .title{ font-size: 16px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .brand-text .tag{ font-size: 12px; color: var(--muted); font-weight: 600; }

    .nav{
      display:flex;
      justify-content:center;
      gap: 8px;
      flex-wrap: wrap;
    }
    .nav a{
      text-decoration:none;
      color: var(--text);
      font-weight: 700;
      font-size: 13px;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid transparent;
      transition: .2s ease;
      white-space: nowrap;
    }
    .nav a:hover{
      background: rgba(255,255,255,.7);
      border-color: var(--stroke);
      transform: translateY(-1px);
    }

    .tools{
      display:flex;
      justify-content:flex-end;
      align-items:center;
      gap: 10px;
    }

    .search{
      position: relative;
      width: min(360px, 100%);
      max-width: 360px;
    }
    .search input{
      width:100%;
      padding: 12px 40px 12px 14px;
      border-radius: 16px;
      border: 1px solid var(--stroke);
      background: rgba(255,255,255,.7);
      outline: none;
      color: var(--text);
      font-weight: 600;
      transition: .2s ease;
    }
    .search input:focus{
      background: #fff;
      border-color: rgba(217,154,168,.65);
      box-shadow: 0 0 0 4px rgba(217,154,168,.18);
    }
    .search .icon{
      position:absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      opacity: .7;
      pointer-events:none;
    }

    .icon-btn{
      width: 42px;
      height: 42px;
      border-radius: 16px;
      border: 1px solid var(--stroke);
      background: rgba(255,255,255,.7);
      display:grid;
      place-items:center;
      cursor:pointer;
      transition:.2s ease;
      box-shadow: 0 6px 18px rgba(42,35,32,.06);
    }
    .icon-btn:hover{ background:#fff; transform: translateY(-1px); }
    .icon-btn svg{ width: 20px; height: 20px; fill: var(--text); opacity:.9; }

    .badge{
      position: relative;
    }
    .badge[data-count]:after{
      content: attr(data-count);
      position:absolute;
      top: -6px;
      right: -6px;
      background: var(--pink);
      color: #fff;
      font-size: 11px;
      font-weight: 800;
      min-width: 18px;
      height: 18px;
      padding: 0 5px;
      border-radius: 999px;
      display:grid;
      place-items:center;
      border: 2px solid var(--bg);
    }

    /* موبايل */
    .mobile-row{
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 16px 12px;
      display:none;
      gap:10px;
      align-items:center;
    }

    .menu-btn{ display:none; }

    @media (max-width: 920px){
      .header-wrap{
        grid-template-columns: 1fr auto;
        grid-template-areas:
          "brand tools"
          "nav nav";
      }
      .brand{ grid-area: brand; }
      .tools{ grid-area: tools; }
      .nav{ grid-area: nav; justify-content:flex-start; }

      .search{ display:none; }
      .menu-btn{ display:grid; }
      .mobile-row{ display:flex; }
      .mobile-row .search{ display:block; width: 100%; max-width: none; }
      .nav{
        max-height: 0;
        overflow: hidden;
        transition: max-height .25s ease;
      }
      .nav.is-open{
        max-height: 220px;
      }
    }
  </style>

  <div class="header-wrap">
    <a class="brand" href="{% url 'home' %}">
      <div class="brand-mark" aria-hidden="true">
        <!-- أيقونة ورقة (عناية/طبيعي) -->
        <svg viewBox="0 0 24 24"><path d="M20.6 3.4c-5.7.2-10 .9-13.2 4.1C4.2 10.7 3.7 15 3.4 20.6c5.6-.3 9.9-.8 13.1-4 3.3-3.3 4-7.6 4.1-13.2zM8.7 15.3c2.1-3.5 5.3-5.8 8.8-7.4-2.9 2.1-5.4 4.5-7.4 8.8-.2.4-.7.6-1.1.4s-.5-.7-.3-1.2z"/></svg>
      </div>
      <div class="brand-text">
        <div class="title">GlowCare</div>
        <div class="tag">عناية لطيفة لبشرة أجمل</div>
      </div>
    </a>

    <div class="tools">
      <button class="icon-btn menu-btn" type="button" id="menuToggle" aria-label="القائمة">
        <svg viewBox="0 0 24 24"><path d="M4 6.5c0-.6.4-1 1-1h14c.6 0 1 .4 1 1s-.4 1-1 1H5c-.6 0-1-.4-1-1zm0 5.5c0-.6.4-1 1-1h14c.6 0 1 .4 1 1s-.4 1-1 1H5c-.6 0-1-.4-1-1zm1 4.5c-.6 0-1 .4-1 1s.4 1 1 1h14c.6 0 1-.4 1-1s-.4-1-1-1H5z"/></svg>
      </button>

      <div class="search" aria-label="بحث">
        <span class="icon" aria-hidden="true">
          <svg viewBox="0 0 24 24" width="18" height="18"><path fill="#2a2320" d="M10 4a6 6 0 104.5 10l3.3 3.3a1 1 0 001.4-1.4L16 12.6A6 6 0 0010 4zm0 2a4 4 0 110 8 4 4 0 010-8z"/></svg>
        </span>
        <!-- اربطيه لاحقًا بصفحة بحث أو باراميتر q -->
        <input id="siteSearch" type="search" placeholder="ابحثي عن غسول، سيروم، مرطب..." autocomplete="off">
      </div>

      <button class="icon-btn badge" data-count="2" type="button" aria-label="السلة">
        <svg viewBox="0 0 24 24"><path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zm10 0c-1.1 0-1.99.9-1.99 2S15.9 22 17 22s2-.9 2-2-.9-2-2-2zM7.2 6l.3 2h11.7c.8 0 1.3.8 1 1.5l-2 5A2 2 0 0116.3 16H9a2 2 0 01-2-1.7L5.3 4H3a1 1 0 110-2h3c.5 0 .9.4 1 .9L7.2 6z"/></svg>
      </button>

      <button class="icon-btn" type="button" aria-label="الحساب">
        <svg viewBox="0 0 24 24"><path d="M12 12a4 4 0 10-4-4 4 4 0 004 4zm0 2c-4.4 0-8 2.2-8 5v1h16v-1c0-2.8-3.6-5-8-5z"/></svg>
      </button>
    </div>

    <nav class="nav" id="mainNav" aria-label="التنقل">
      <a href="{% url 'home' %}">الرئيسية</a>
      <a href="#">جميع المنتجات</a>
      <a href="#">الأكثر مبيعًا</a>
      <a href="#">مجموعات البشرة</a>
      <a href="#">العروض</a>
      <a href="#">تواصل معنا</a>
    </nav>
  </div>

  <div class="mobile-row">
    <div class="search" aria-label="بحث (موبايل)">
      <span class="icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" width="18" height="18"><path fill="#2a2320" d="M10 4a6 6 0 104.5 10l3.3 3.3a1 1 0 001.4-1.4L16 12.6A6 6 0 0010 4zm0 2a4 4 0 110 8 4 4 0 010-8z"/></svg>
      </span>
      <input id="siteSearchMobile" type="search" placeholder="ابحثي عن منتجات العناية..." autocomplete="off">
    </div>
  </div>

  <script>
    (function(){
      const btn = document.getElementById('menuToggle');
      const nav = document.getElementById('mainNav');
      if(btn && nav){
        btn.addEventListener('click', () => {
          nav.classList.toggle('is-open');
        });
      }

      // تحسين بسيط: مزامنة بحث الموبايل مع البحث الأساسي
      const d = (id) => document.getElementById(id);
      const a = d('siteSearch');
      const b = d('siteSearchMobile');
      const sync = (from, to) => {
        if(!from || !to) return;
        from.addEventListener('input', () => { to.value = from.value; });
      };
      sync(a, b); sync(b, a);
    })();
  </script>
</header>
